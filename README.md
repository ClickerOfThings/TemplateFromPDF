# TemplateFromPDF
Данная программа предназначена для создания PDF-шаблонов из полей в PDF файле и изначального изображения-шаблона (такого как сертификат). На данный момент в программе доступна статичная настройка вставляемого текста вместе со сборкой программы (см. [Изменение настроек вставляемых строк]).
## Зависимости
Данная программа использует библиотеку [iText 7](https://www.nuget.org/packages/itext7) для обработки и создания PDF файлов, и [Microsoft-WindowsAPICodePack-Shell](https://www.nuget.org/packages/Microsoft-WindowsAPICodePack-Shell/1.1.4?_src=template) для вывода окна выбора папки.
## Использование
Данная программа используется в несколько этапов (в виде окон):
1. выбор базовых PDF файлов - PDF файлы для использования программой должны иметь поля в виде заголовка и значения поля. Заголовок отделяется от значения единичной новой строкой, а поля между собой должны разделяться двойной новой строкой. На данном этапе возможно выбрать один или несколько PDF файлов, которые будут обработаны;
2. просмотр и изменение полей PDF файлов - на данном этапе, если все файлы были успешно прочитаны, пользователь может просмотреть извлечённые данные и, по необходимости, отредактировать их;
3. сохранение нового файла-шаблона - на данном этапе, в зависимости от сборки (см. [Разница в конфигурациях приложения]), пользователю будут предложены окончательные настройки для сохранения новых файлов шаблона. Основными настройками, общими для всех конфигураций приложения, являются:
    * папка, куда сохранятся все новые PDF-шаблоны;
    * базовое изображения, на который будет наложен текст в новом PDF-шаблоне.
## Изменение настроек вставляемых строк
Настройки вставляемых строк в новый PDF-шаблон жёстко закодирован в сборку программы. Для изменения данных настроек, в файле 'PDFFile.cs' нужно изменить соответствующую константу `DEFAULT_PARAGRAPH_WRAPS`, которая является массивом объектов класса `ParagraphWrap` с настройками вставляемых полей. Возможности класса описаны в документации в соответствующем файле.
## Разница в конфигурациях приложения
Данный проект имеет 4 конфигурации, базовые из них - Debug и Release, и для каждой из них создана вариация с суффиксом 'WithBasename'.
* при сборке проекта с суффиксом 'WithBasename', программа использует окно с требованием ввести базовое название для создаваемых файлов. Например, если выбраны 3 PDF файла, и введено базовое название "new-file", то выходные PDF-шаблоны будут иметь названия "new-file-1.pdf", "new-file-2.pdf", "new-file-3.pdf" и т.д;
* при сборке проекта без суффикса 'WithBasename', программа будет использовать поле "Фамилия Имя Отчество" из базовых PDF файлов для названия новых PDF-шаблонов. Если в базовых PDF файлах не предусмотрены такие поля, то необходимо использовать сборку программы с суффиксом 'WithBasename'.